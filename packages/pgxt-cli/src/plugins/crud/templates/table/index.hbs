import tableInit from "{{importPathmap.table}}";
import factory from "..";
import type { RecordT, InsertT } from "./typeLiterals";

export * from "./typeLiterals";

export const columns = [
{{#each table.columns}}  "{{name}}",
{{/each}}
] as const;

export type ColumnT =
{{#each table.columns}}  | "{{name}}"
{{/each}};

export const {
  useWrapper,
  createWrapper,
  updateWrapper,
  deleteWrapper,
  retrieveWrapper,
  listWrapper,
} = factory<
  "{{table.moduleName}}",
  ColumnT
>(
  tableInit(),
  columns,
  {
    primaryKey: "{{table.primaryKey}}",
  },
)

type ParamsT = {}

export const use = useWrapper<ParamsT>()

export const get = listWrapper<
  ParamsT,
  () => Promise<Array<RecordT>>
>()

export const post = createWrapper<
  ParamsT,
  (payload: InsertT) => Promise<RecordT>
>()

export default (
  factory: (a: {
    use: typeof use;
    get: typeof get;
    post: typeof post;
  }) => Array<any>
) => factory({ use, get, post });
